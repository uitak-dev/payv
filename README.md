# 소개
payv는 **DDD(도메인 주도 설계)** 를 바탕으로, **Modular Monolithic Architecture(모듈러 모놀리식 아키텍처)** 기반 수입/지출 관리 서비스입니다. 
가계부를 단순 CRUD로 구현하는 수준을 넘어, 도메인의 변화 가능성·확장성을 고려해 설계하였으며, **Spring Boot의 자동 구성을 사용하지 않고 레거시 스택(Spring MVC + XML + WAR)** 을 직접 구성하여 프레임워크 동작 원리를 학습하고 검증하는 것을 목표로 삼았습니다.


# 핵심 특징
### 레거시 스택 구성
Spring Boot 대신 Spring MVC, Spring Security, MyBatis 등을 수동 설정하여 DI 컨텍스트, 트랜잭션, 커넥션 풀, 필터 체인 흐름을 직접 제어합니다. 
이를 통해 자동 설정이 감추는 동작을 파악하고 장애·설정 문제를 해결할 수 있는 역량을 키웠습니다.
### DDD + OOP(SOLID/RDD)
애그리거트/엔티티/VO/Policy 구조를 적용하여 규칙과 책임을 도메인에 고정합니다. 
Presentation–Application–Domain–Infrastructure 레이어를 분리하여 변경 범위를 명확하게 합니다.
### CQRS-lite 적용
통계와 리포트를 위한 읽기 모델을 분리하여 도메인은 규칙에 집중하고, 조회는 MyBatis 집계 SQL과 조회 전용 DTO로 성능과 단순성을 확보했습니다.
### 원자성 보장
이체(Transfer)는 출금과 입금을 하나의 트랜잭션 경계에서 처리하며 중간 실패 시 전체 롤백되도록 모델링했습니다.


# 모듈 구조
멀티 모듈 Maven 프로젝트로 구성되어 있으며, 핵심 모듈은 다음과 같습니다:
| 모듈                 | 설명                                                                |
| ------------------ | ----------------------------------------------------------------- |
| **common**         | 공통 유틸리티와 예외, 공통 도메인 클래스를 제공합니다.                                   |
| **iam**            | 로그인/권한 등 인증·인가 기능을 담당합니다.                                         |
| **asset**          | 자산(Account) 타입 관리 및 잔액 변화를 처리합니다.                                 |
| **classification** | 수입/지출 카테고리의 2단계 트리 구조를 관리합니다.                                     |
| **ledger**         | 사용자의 가계부(Ledger)와 거래(Transaction), 이체(Transfer) 핵심 도메인 로직을 포함합니다. |
| **budget**         | 월별 예산 설정과 사용률 계산, 초과 여부 판단을 위한 Policy를 제공합니다.                     |
| **reporting**      | 월별 지출 요약, 카테고리별 비중/합계, 계좌별 사용량 등 리포트 API를 구현합니다.                  |
| **app-web**        | JSP/JSTL 기반의 UI와 Spring MVC Controller를 포함하는 Web 모듈입니다.           |

> 현재 `modules/transfer`와 `modules/automation` 모듈은 추후 확장을 위해 주석 처리되어 있습니다.

# 주요 기능
### Ledger(가계부)
* 사용자는 하나 이상의 Ledger를 생성할 수 있으며, Ledger 단위로 자산·카테고리·예산·거래 데이터가 분리됩니다.
* Ledger를 애그리거트 루트로 설정하여 동일 가계부 내부의 데이터 정합성을 강화하고 향후 가족/공동 가계부로 확장할 수 있는 기반을 마련했습니다.

### Account(자산)
* 현금·은행·카드 등 다양한 자산 타입을 지원하며, 잔액을 Money VO로 관리하여 금액 연산과 검증을 캡슐화합니다.
* 모든 자산 변경 시 Ledger 소유 관계를 검증해 다른 가계부의 계좌를 참조하는 오류를 구조적으로 방지합니다.

### Category(카테고리)
* 사용자가 직접 수입/지출 카테고리를 관리할 수 있으며, 2단계 계층 구조(예: 식비 > 외식)를 지원합니다.
* 리포트 시 상위 카테고리 선택 시 하위 카테고리 ID를 모아 한번에 집계 SQL을 수행합니다.

### Transaction(거래)
* 수입/지출 거래 내역을 등록·수정·삭제하며, 기간/자산/카테고리 기준 조회를 지원합니다.
* 컨트롤러에서 입력값을 검증 후 DTO 변환을 수행하고, Use Case(Service) 레이어에서 Ledger/Account/Category 존재 및 소유권 검증, Transaction 생성을 처리합니다.

### Transfer(이체)
* 출금과 입금을 각각 하나의 Transaction으로 모델링하여 원자성을 보장합니다.
* 유스케이스 레이어에서 단일 트랜잭션 경계를 지정하고 실패 시 전체 롤백되도록 구현해 잔액 불일치와 데이터 손상을 방지합니다.

### Budget(예산)
* 월(YearMonth) + 카테고리 기준으로 예산을 설정할 수 있습니다.
* 지출 합계와 예산 사용률을 계산하고 초과 여부를 BudgetPolicy로 분리하여 향후 임계치 경고, 가중치 적용 등 규칙 변경에 유연하게 대응합니다.

### Reporting(통계/리포트)
* 월별 지출 요약, 카테고리별 비중·합계, 계좌별 사용량 등을 제공하는 리포트 API와 화면을 제공합니다.
* 도메인 모델과 분리된 조회 전용 DTO와 MyBatis 집계 SQL을 사용해 조회 성능을 최적화했습니다.



